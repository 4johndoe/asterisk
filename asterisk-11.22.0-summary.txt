                                Release Summary

                                asterisk-11.22.0

                                Date: 2016-03-29

                           <asteriskteam@digium.com>

     ----------------------------------------------------------------------

                               Table of Contents

    1. Summary
    2. Contributors
    3. Closed Issues
    4. Open Issues
    5. Other Changes
    6. Diffstat

     ----------------------------------------------------------------------

                                    Summary

                                 [Back to Top]

   This release is a point release of an existing major version. The changes
   included were made to address problems that have been identified in this
   release series, or are minor, backwards compatible new features or
   improvements. Users should be able to safely upgrade to this version if
   this release series is already in use. Users considering upgrading from a
   previous version are strongly encouraged to review the UPGRADE.txt
   document as well as the CHANGES document for information about upgrading
   to this release series.

   The data in this summary reflects changes that have been made since the
   previous release, asterisk-11.21.0.

     ----------------------------------------------------------------------

                                  Contributors

                                 [Back to Top]

   This table lists the people who have submitted code, those that have
   tested patches, as well as those that reported issues on the issue tracker
   that were resolved in this release. For coders, the number is how many of
   their patches (of any size) were committed into this release. For testers,
   the number is the number of times their name was listed as assisting with
   testing a patch. Finally, for reporters, the number is the number of
   issues that they reported that were affected by commits that went into
   this release.

   Coders                        Testers               Reporters              
   15 Richard Mudgett            2 Badalyan Vyacheslav 7 Corey Farrell        
   9 Corey Farrell               1 Aaron An            4 Badalian Vyacheslav  
   4 Dade Brandon                1 XenCALL             2 Gianluca Merlo       
   4 Mark Michelson              1 Stefan EngstrAP:m   2 Joshua Colp          
   4 Mark Michelson                                    2 Dade Brandon         
   3 Joshua Colp                                       1 Rusty Newton         
   3 gtjoseph                                          1 ibercom              
   2 Kevin Harwell                                     1 Walter Doekes        
   2 Gianluca Merlo                                    1 Etienne Lessard      
   2 Diederik de Groot                                 1 Carlos Oliva         
   2 Badalyan Vyacheslav                               1 Etienne Lessard      
   1 Rodrigo RamArez Norambuena                        1 Sean Bright          
   1 Etienne Lessard (license                          1 sungtae kim          
   #6394)                                              1 Rodrigo Ramirez      
   1 Karsten Wemheuer                                  Norambuena             
   1 sungtae kim                                       1 Krzysztof Trempala   
   1 Walter Doekes                                     1 Walter Doekes        
   1 Aaron An                                          1 David Cunningham     
   1 Rusty Newton                                      1 George Joseph        
   1 Martin Tomec                                      1 Badalyan Vyacheslav  
   1 Christof Lauber                                   1 Aaron An             
   1 Carlos Oliva                                      1 XenCALL              
   1 Stefan EngstrAP:m                                 1 Diederik de Groot    
   1 Sean Bright                                       1 Aaron An             
                                                       1 WRP                  
                                                       1 David Cunningham     
                                                       1 Alexander Traud      
                                                       1 Alex A. Welzl        
                                                       1 Krzysztof Trempala   
                                                       1 hristo               
                                                       1 gtjoseph             
                                                       1 Badalian Vyacheslav  
                                                       1 Filip Frank          
                                                       1 Alexander Traud      
                                                       1 Torrey Searle        
                                                       1 Karsten Wemheuer     

     ----------------------------------------------------------------------

                                 Closed Issues

                                 [Back to Top]

   This is a list of all issues from the issue tracker that were closed by
   changes that went into this release.

  Bug

    Category: Addons/General

   ASTERISK-25640: pbx: Deadlock on features reload and state change hint.
   Reported by: Krzysztof Trempala
     * [6744b09a99] Kevin Harwell -- pbx: Deadlock between contexts container
       and context_merge locks

    Category: Applications/app_chanspy

   ASTERISK-25321: [patch]DeadLock ChanSpy with call over Local channel
   Reported by: Filip Frank
     * [d4c3b62fd2] Walter Doekes -- app_chanspy: Fix occasional deadlock
       with ChanSpy and Local channels.

    Category: Applications/app_confbridge

   ASTERISK-20987: non-admin users, who join muted conference are not being
   muted
   Reported by: hristo
     * [afcb151472] Richard Mudgett -- app_confbridge: Make non-admin users
       join a muted conference muted.

    Category: Applications/app_queue

   ASTERISK-25800: [patch] Calculate talktime when is first call answered
   Reported by: Rodrigo Ramirez Norambuena
     * [ab11e72ce5] Rodrigo RamArez Norambuena -- app_queue: fix Calculate
       talktime when is first call answered
   ASTERISK-25442: using realtime (mysql) queue members are never updated in
   wait_our_turn function (app_queue.c)
   Reported by: Carlos Oliva
     * [54f6f54a5f] Carlos Oliva -- app_queue: update RT members when the 1st
       call joins a queue with no agents

    Category: CEL/General

   ASTERISK-25647: bug of cel_radius.c: wrong point of ADD_VENDOR_CODE
   Reported by: Aaron An
     * [2b0747817f] Aaron An -- cel/cel_radius: Fix wrong pointer.

    Category: Channels/chan_sip/General

   ASTERISK-25397: [patch]chan_sip: File descriptor leak with non-default
   timert1
   Reported by: Alexander Traud
     * [882e853882] Richard Mudgett -- AST-2016-002 chan_sip.c: Fix
       retransmission timeout integer overflow.

    Category: Channels/chan_sip/Security Framework

   ASTERISK-25722: ASAN & testsute: stack-buffer-overflow in sip_sipredirect
   Reported by: Badalian Vyacheslav
     * [36aa50aded] Corey Farrell -- chan_sip: Fix buffer overrun in
       sip_sipredirect.

    Category: Core/BuildSystem

   ASTERISK-25730: build: make uninstall after make distclean tries to remove
   root
   Reported by: George Joseph
     * [998ef420d0] gtjoseph -- build_system: Prevent goals needing makeopts
       from running when it's missing

    Category: Core/Channels

   ASTERISK-25690: Hanging up when executing connected line sub does not
   cause hangup
   Reported by: Joshua Colp
     * [656bd42b11] Joshua Colp -- app: Queue hangup if channel is hung up
       during sub or macro execution.

    Category: Core/Configuration

   ASTERISK-25700: main/config: Clean config maps on shutdown.
   Reported by: Corey Farrell
     * [ddb3387560] Corey Farrell -- main/config: Clean config maps on
       shutdown.

    Category: Core/General

   ASTERISK-25701: core: Endless loop in "core show taskprocessors"
   Reported by: ibercom
     * [aef26eff79] Richard Mudgett -- taskprocessor.c: Fix endless loop in
       CLI "core show taskprocessor"
   ASTERISK-25681: devicestate: Engine thread is not shut down
   Reported by: Corey Farrell
     * [b41d4ce58e] Corey Farrell -- devicestate: Cleanup engine thread
       during graceful shutdown.

    Category: Core/ManagerInterface

   ASTERISK-25680: manager: manager_channelvars is not cleaned at shutdown
   Reported by: Corey Farrell
     * [ef67dc11bd] Corey Farrell -- manager: Cleanup manager_channelvars
       during shutdown.
   ASTERISK-25624: AMI Event OriginateResponse bug
   Reported by: sungtae kim
     * [b9f9ffb351] sungtae kim -- AMI: Fixed OriginateResponse message

    Category: Core/ManagerInterface/NewFeature

   ASTERISK-25624: AMI Event OriginateResponse bug
   Reported by: sungtae kim
     * [b9f9ffb351] sungtae kim -- AMI: Fixed OriginateResponse message

    Category: Core/PBX

   ASTERISK-25394: pbx: Incorrect device and presence state when changing
   hint details
   Reported by: Joshua Colp
     * [6744b09a99] Kevin Harwell -- pbx: Deadlock between contexts container
       and context_merge locks

    Category: Core/UDPTL

   ASTERISK-25603: [patch]udptl: Uninitialized lengths and bufs in
   udptl_rx_packet cause ast_frdup crash
   Reported by: Walter Doekes
     * [da2573a377] Richard Mudgett -- AST-2016-003 udptl.c: Fix
       uninitialized values.
   ASTERISK-25742: Secondary IFP Packets can result in accessing
   uninitialized pointers and a crash
   Reported by: Torrey Searle
     * [da2573a377] Richard Mudgett -- AST-2016-003 udptl.c: Fix
       uninitialized values.

    Category: Functions/func_aes

   ASTERISK-25857: func_aes: incorrect use of strlen() leads to data
   corruption
   Reported by: Gianluca Merlo
     * [91bdaa9251] Gianluca Merlo -- func_aes: fix misuse of strlen on
       binary data

    Category: Functions/func_iconv

   ASTERISK-25272: [patch]The ICONV dialplan function sometimes returns
   garbage
   Reported by: Etienne Lessard
     * [9c83062c31] Etienne Lessard -- func_iconv: Ensure output strings are
       properly terminated.

    Category: PBX/pbx_dundi

   ASTERISK-25677: pbx_dundi: leaks during failed load.
   Reported by: Corey Farrell
     * [656f7430f8] Corey Farrell -- pbx_dundi: Run cleanup on failed load.

    Category: Resources/res_calendar

   ASTERISK-25679: res_calendar leaks scheduler.
   Reported by: Corey Farrell
     * [006ce3679c] Corey Farrell -- res_calendar: Cleanup scheduler context
       at unload.

    Category: Resources/res_crypto

   ASTERISK-25673: res_crypto leaks CLI entries
   Reported by: Corey Farrell
     * [d2fd720290] Corey Farrell -- res_crypto: Perform cleanup at shutdown.

    Category: Resources/res_http_websocket

   ASTERISK-24972: Transport Layer Security (TLS) Protocol BEAST
   Vulnerability - Investigate vulnerability of HTTP server
   Reported by: Alex A. Welzl
     * [f233bcd81d] Joshua Colp -- AST-2016-001 http: Provide greater control
       of TLS and set modern defaults.

    Category: Resources/res_musiconhold

   ASTERISK-25687: res_musiconhold: Concurrent invocations of 'moh reload'
   cause a crash
   Reported by: Sean Bright
     * [2d29e67567] Sean Bright -- res_musiconhold: Prevent multiple
       simultaneous reloads.

  Improvement

    Category: Core/General

   ASTERISK-24813: asterisk.c: #if statement in listener() confuses code
   folding editors
   Reported by: Corey Farrell
     * [95e76368eb] Corey Farrell -- main/asterisk.c: Reverse #if statement
       in listener() to fix code folding.

    Category: Sounds

   ASTERISK-25068: Move commonly used FreePBX extra sounds to the core set
   Reported by: Rusty Newton
     * [3918ccd6d9] Rusty Newton -- sounds/Makefile: Incremented core and
       extra sounds versions to 1.5

     ----------------------------------------------------------------------

                                  Open Issues

                                 [Back to Top]

   This is a list of all open issues from the issue tracker that were
   referenced by changes that went into this release.

  Bug

    Category: Applications/app_amd

   ASTERISK-25639: app_amd: system maxwords discrepency
   Reported by: Dade Brandon
     * [4dd42c1cfa] Dade Brandon -- app_amd: Correct documentation to reflect
       functionality

    Category: Applications/app_queue

   ASTERISK-19820: wrapuptime is intermittently disregarded for queue calls
   Reported by: WRP
     * [1943cfc53c] Martin Tomec -- app_queue: Add member flag "in_call" to
       prevent reading wrong lastcall time

    Category: Core/Configuration

   ASTERISK-25612: Configuration parser handles unsigned integers as signed
   integers
   Reported by: Gianluca Merlo
     * [613fdff543] Gianluca Merlo -- config: fix flags in uint option
       handler

    Category: Core/General

   ASTERISK-25307: Hangup on channel using FastAGI does not hang up child
   channels
   Reported by: David Cunningham
     * [6bbb59e348] Richard Mudgett -- app_dial: Immediately exit dial if the
       caller is already hung up.

    Category: Resources/res_xmpp

   ASTERISK-25735: [patch] res_xmpp: Does not connect in component mode
   Reported by: Karsten Wemheuer
     * [78fb989209] Karsten Wemheuer -- res_xmpp: Does not connect in
       component mode

  Improvement

    Category: Core/General

   ASTERISK-25627: Easily Preventable Compile Warning
   Reported by: Diederik de Groot
     * [7188c72a07] Diederik de Groot -- include/asterisk/time.h: Renamed
       global declaration:tv

     ----------------------------------------------------------------------

                      Commits Not Associated with an Issue

                                 [Back to Top]

   This is a list of all changes that went into this release that did not
   reference a JIRA issue.

   +------------------------------------------------------------------------+
   | Revision   | Author            | Summary                               |
   |------------+-------------------+---------------------------------------|
   | 6888d6f374 | Mark Michelson    | Release summaries: Remove previous    |
   |            |                   | versions                              |
   |------------+-------------------+---------------------------------------|
   | eb671163fa | Mark Michelson    | .version: Update for 11.22.0          |
   |------------+-------------------+---------------------------------------|
   | 5d94b7d61b | Mark Michelson    | .lastclean: Update for 11.22.0        |
   |------------+-------------------+---------------------------------------|
   | 11b0fb111b | Mark Michelson    | ChangeLog: Updated for 11.22.0-rc1    |
   |------------+-------------------+---------------------------------------|
   | e1a49fbbd3 | Mark Michelson    | Release summaries: Add summaries for  |
   |            |                   | 11.22.0-rc1                           |
   |------------+-------------------+---------------------------------------|
   | ce02b678fa | Mark Michelson    | .version: Update for 11.22.0-rc1      |
   |------------+-------------------+---------------------------------------|
   | 52cbd99b4a | Mark Michelson    | .lastclean: Update for 11.22.0-rc1    |
   |------------+-------------------+---------------------------------------|
   | 1d87a4dc4b | Richard Mudgett   | chan_sip.c: Simplify sip_pvt          |
   |            |                   | destructor call levels.               |
   |------------+-------------------+---------------------------------------|
   | 33b56c90c6 | Richard Mudgett   | chan_sip.c: Made sip_reinvite_retry() |
   |            |                   | call sip_pvt_lock_full().             |
   |------------+-------------------+---------------------------------------|
   | 5a9853c113 | Richard Mudgett   | chan_sip.c: Suppress T.38 SDP c= line |
   |            |                   | if addr is the same.                  |
   |------------+-------------------+---------------------------------------|
   | 8ba5eb42f5 | Christof Lauber   | res_config_sqlite3: Fix crashes when  |
   |            |                   | reading peers from sqlite3 tables     |
   |------------+-------------------+---------------------------------------|
   | 369981e5be | Richard Mudgett   | cel.c: Fix mismatch in                |
   |            |                   | ast_cel_track_event() return type.    |
   |------------+-------------------+---------------------------------------|
   | 598685f8a5 | Badalyan          | Build: Fix menuselect USAN conflicts  |
   |            | Vyacheslav        |                                       |
   |------------+-------------------+---------------------------------------|
   | afb4a93280 | Corey Farrell     | Simplify and fix conditional in       |
   |            |                   | FD_SET.                               |
   |------------+-------------------+---------------------------------------|
   | 26fdf8a77e | gtjoseph          | chan_misdn: Fix a few issues causing  |
   |            |                   | compile errors                        |
   |------------+-------------------+---------------------------------------|
   | f906843818 | Mark Michelson    | Check for OpenSSL defines before      |
   |            |                   | trying to use them.                   |
   |------------+-------------------+---------------------------------------|
   |            |                   | chan_sip.c: AMI & CLI notify methods  |
   | e6c4a926c2 | Stefan EngstrAP:m | get different values of asterisk's    |
   |            |                   | own ip.                               |
   |------------+-------------------+---------------------------------------|
   | b04087a8e1 | Richard Mudgett   | app_confbridge.c: Update CONFBRIDGE   |
   |            |                   | and CONFBRIDGE_INFO documentation.    |
   |------------+-------------------+---------------------------------------|
   | d826a61975 | Richard Mudgett   | astmm.c: Add more stats to CLI        |
   |            |                   | "memory show" commands.               |
   |------------+-------------------+---------------------------------------|
   | 48dd99d2b4 | Richard Mudgett   | taskprocessor.c: Fix CLI "core show   |
   |            |                   | taskprocessors" unref.                |
   |------------+-------------------+---------------------------------------|
   | b6c4746409 | Richard Mudgett   | ccss.c: Replace space in              |
   |            |                   | taskprocessor name.                   |
   |------------+-------------------+---------------------------------------|
   | 32cbf1e429 | Richard Mudgett   | taskprocessor.c: Add CLI "core ping   |
   |            |                   | taskprocessor" missing unlock.        |
   |------------+-------------------+---------------------------------------|
   | 594b6a426b | gtjoseph          | asterisk.h: Add                       |
   |            |                   | ASTERISK_REGISTER_FILE macro          |
   |------------+-------------------+---------------------------------------|
   | c8499b8d5a | Joshua Colp       | test_time: Provide a timeout when     |
   |            |                   | waiting.                              |
   |------------+-------------------+---------------------------------------|
   |            |                   | res_http_websocket.c: prevent         |
   | 10435bfa69 | Dade Brandon      | avoidable disconnections caused by    |
   |            |                   | write errors                          |
   |------------+-------------------+---------------------------------------|
   | 6929d2a428 | Dade Brandon      | chan_sip.c: fix                       |
   |            |                   | websocket_write_timeout default value |
   |------------+-------------------+---------------------------------------|
   | 3066b80259 | Kevin Harwell     | res_rtp_asterisk: rtp->ice check not  |
   |            |                   | wrapped in USE_PJPROJECT ifdef        |
   +------------------------------------------------------------------------+

     ----------------------------------------------------------------------

                                Diffstat Results

                                 [Back to Top]

   This is a summary of the changes to the source code that went into this
   release that was generated using the diffstat utility.

 asterisk-11.21.0-summary.html       |  153 -------
 asterisk-11.21.0-summary.txt        |  458 ---------------------
 b/.version                          |    2
 b/ChangeLog                         |  782 ++++++++++++++++++++++++++++++++++--
 b/Makefile                          |    5
 b/apps/app_amd.c                    |   16
 b/apps/app_chanspy.c                |    8
 b/apps/app_confbridge.c             |   81 ++-
 b/apps/app_dial.c                   |   18
 b/apps/app_queue.c                  |   78 +++
 b/build_tools/cflags.xml            |   10
 b/build_tools/menuselect-deps.in    |    4
 b/cel/cel_radius.c                  |    4
 b/channels/chan_misdn.c             |    4
 b/channels/chan_sip.c               |   63 +-
 b/channels/misdn_config.c           |    2
 b/channels/sip/include/dialog.h     |   13
 b/configs/amd.conf.sample           |   30 -
 b/configs/confbridge.conf.sample    |   10
 b/configs/http.conf.sample          |   21
 b/configure                         |  230 ++++++++++
 b/configure.ac                      |   70 +++
 b/funcs/func_aes.c                  |    2
 b/funcs/func_iconv.c                |    3
 b/include/asterisk.h                |   20
 b/include/asterisk/autochan.h       |   20
 b/include/asterisk/autoconfig.h.in  |    6
 b/include/asterisk/http_websocket.h |    4
 b/include/asterisk/select.h         |    4
 b/include/asterisk/tcptls.h         |   10
 b/include/asterisk/time.h           |   10
 b/main/app.c                        |   10
 b/main/asterisk.c                   |   12
 b/main/astmm.c                      |  107 ++++
 b/main/autochan.c                   |    6
 b/main/ccss.c                       |    2
 b/main/cel.c                        |    2
 b/main/config.c                     |    2
 b/main/config_options.c             |    2
 b/main/devicestate.c                |   16
 b/main/http.c                       |    7
 b/main/logger.c                     |    2
 b/main/manager.c                    |   57 +-
 b/main/stdtime/localtime.c          |    5
 b/main/taskprocessor.c              |    1
 b/main/tcptls.c                     |   35 +
 b/main/udptl.c                      |   15
 b/pbx/pbx_dundi.c                   |   21
 b/res/res_calendar.c                |    2
 b/res/res_config_sqlite3.c          |   16
 b/res/res_crypto.c                  |    8
 b/res/res_http_websocket.c          |   30 -
 b/res/res_musiconhold.c             |    6
 b/res/res_rtp_asterisk.c            |   51 +-
 54 files changed, 1678 insertions(+), 878 deletions(-)
